<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ward Academy - Gerador de Cronogramas</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --secondary: #10b981;
            --accent: #8b5cf6;
            --danger: #ef4444;
            --dark: #1f2937;
            --light: #f3f4f6;
            --white: #ffffff;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --week-color-1: #e0f2fe;
            --week-color-2: #f0fdf4;
            --week-color-3: #fef3c7;
            --week-color-4: #fce7f3;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: var(--white);
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            max-width: 1400px;
            margin: 0 auto;
            overflow: hidden;
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: var(--gradient);
            padding: 40px;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .logo {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            display: inline-block;
        }

        .logo::after {
            content: 'ðŸŽ“';
            position: absolute;
            top: -10px;
            right: -40px;
            font-size: 1.5rem;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .tagline {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 300;
            letter-spacing: 2px;
        }

        .subtitle {
            margin-top: 10px;
            font-size: 0.95rem;
            opacity: 0.9;
        }

        .form-container {
            padding: 40px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .form-group {
            position: relative;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            font-size: 0.95rem;
            letter-spacing: 0.5px;
        }

        input[type="text"],
        input[type="date"],
        select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--white);
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
        }

        .days-off-container {
            margin-top: 20px;
            padding: 20px;
            background: var(--light);
            border-radius: 12px;
        }

        .days-off-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 15px;
        }

        .weekday-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .weekday-checkbox {
            display: none;
        }

        .weekday-label {
            padding: 10px 20px;
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .weekday-checkbox:checked + .weekday-label {
            background: var(--danger);
            color: white;
            border-color: var(--danger);
        }

        .organization-section {
            margin-top: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-radius: 12px;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .radio-option {
            display: flex;
            align-items: center;
        }

        .radio-option input[type="radio"] {
            margin-right: 8px;
            width: 18px;
            height: 18px;
        }

        .sortable-list {
            list-style: none;
            padding: 0;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            background: white;
            border-radius: 8px;
            padding: 10px;
        }

        .sortable-item {
            padding: 12px 15px;
            margin: 5px 0;
            background: var(--light);
            border-radius: 8px;
            cursor: move;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .sortable-item:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .sortable-item.dragging {
            opacity: 0.5;
        }

        .sortable-item.removed {
            background: #fee2e2;
            text-decoration: line-through;
            opacity: 0.6;
        }

        .item-controls {
            display: flex;
            gap: 10px;
        }

        .item-handle {
            cursor: move;
            color: #9ca3af;
        }

        .item-remove {
            cursor: pointer;
            color: var(--danger);
            font-weight: bold;
            padding: 0 5px;
        }

        .item-restore {
            cursor: pointer;
            color: var(--secondary);
            font-size: 0.9rem;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            flex: 1;
            min-width: 200px;
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
        }

        .btn-secondary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .preview-container {
            margin-top: 40px;
            padding: 20px;
            background: var(--light);
            border-radius: 12px;
            max-height: 500px;
            overflow-y: auto;
            display: none;
        }

        .preview-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.9rem;
            color: #6b7280;
            margin-top: 5px;
        }

        .preview-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }

        .preview-table th {
            background: var(--gradient);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
        }

        .preview-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #e5e7eb;
            font-size: 0.9rem;
        }

        .preview-table tr:hover {
            background: #f9fafb;
        }

        .week-1 { background-color: var(--week-color-1) !important; }
        .week-2 { background-color: var(--week-color-2) !important; }
        .week-3 { background-color: var(--week-color-3) !important; }
        .week-4 { background-color: var(--week-color-4) !important; }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 3px solid var(--light);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .info-card {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-left: 4px solid var(--primary);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
        }

        .info-card h3 {
            color: var(--dark);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .info-card p {
            color: #6b7280;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">WARD ACADEMY</div>
            <div class="tagline">De Old para Old</div>
            <div class="subtitle">Gerador de Cronogramas para USMLE Step 2 CK - Boards and Beyond</div>
        </div>
        
        <div class="form-container">
            <div class="info-card">
                <h3>ðŸ“š Como funciona?</h3>
                <p>Configure seu cronograma personalizado: escolha dias off, organize por Subject ou System, e reordene ou remova tÃ³picos conforme sua necessidade. As aulas serÃ£o distribuÃ­das uniformemente nos dias disponÃ­veis.</p>
            </div>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="studentName">ðŸ‘¤ Nome do Aluno</label>
                    <input type="text" id="studentName" placeholder="Digite seu nome completo">
                </div>
                
                <div class="form-group">
                    <label for="startDate">ðŸ“… Data de InÃ­cio</label>
                    <input type="date" id="startDate">
                </div>
                
                <div class="form-group">
                    <label for="endDate">ðŸŽ¯ Data de TÃ©rmino (First Pass)</label>
                    <input type="date" id="endDate">
                </div>
            </div>

            <div class="days-off-container">
                <div class="days-off-title">ðŸš« Days Off - Dias sem estudo</div>
                <div class="weekday-selector">
                    <input type="checkbox" id="day-0" class="weekday-checkbox" value="0">
                    <label for="day-0" class="weekday-label">Domingo</label>
                    
                    <input type="checkbox" id="day-1" class="weekday-checkbox" value="1">
                    <label for="day-1" class="weekday-label">Segunda</label>
                    
                    <input type="checkbox" id="day-2" class="weekday-checkbox" value="2">
                    <label for="day-2" class="weekday-label">TerÃ§a</label>
                    
                    <input type="checkbox" id="day-3" class="weekday-checkbox" value="3">
                    <label for="day-3" class="weekday-label">Quarta</label>
                    
                    <input type="checkbox" id="day-4" class="weekday-checkbox" value="4">
                    <label for="day-4" class="weekday-label">Quinta</label>
                    
                    <input type="checkbox" id="day-5" class="weekday-checkbox" value="5">
                    <label for="day-5" class="weekday-label">Sexta</label>
                    
                    <input type="checkbox" id="day-6" class="weekday-checkbox" value="6">
                    <label for="day-6" class="weekday-label">SÃ¡bado</label>
                </div>
            </div>

            <div class="organization-section">
                <label style="margin-bottom: 15px; display: block;">ðŸ“Š Organizar cronograma por:</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="orgSubject" name="organization" value="subject" checked>
                        <label for="orgSubject">Subject</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="orgSystem" name="organization" value="system">
                        <label for="orgSystem">System</label>
                    </div>
                </div>
                
                <div id="organizationList"></div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="generateSchedule()">
                    âœ¨ Gerar Cronograma
                </button>
                <button class="btn btn-secondary" id="downloadBtn" onclick="downloadExcel()" disabled>
                    ðŸ“¥ Baixar Excel
                </button>
            </div>
            
            <div class="loading">
                <div class="spinner"></div>
                <p style="margin-top: 15px; color: var(--dark);">Gerando seu cronograma...</p>
            </div>
            
            <div class="preview-container" id="previewContainer">
                <h3 style="margin-bottom: 20px; color: var(--dark);">ðŸ“‹ PrÃ©via do Cronograma</h3>
                <div class="stats-grid" id="statsGrid"></div>
                <div id="previewTable"></div>
            </div>
        </div>
    </div>

    <script>
const courseData = {
  "lectures": [
    {
      "lecture": "Behavioral Science â€º Ethics Principles",
      "duration": "15m",
      "subject": "Behavioral Sciences",
      "system": "Social Sciences"
    },
    {
      "lecture": "Behavioral Science â€º Informed Consent",
      "duration": "21m",
      "subject": "Behavioral Sciences",
      "system": "Social Sciences"
    },
    {
      "lecture": "Behavioral Science â€º Confidentiality",
      "duration": "16m",
      "subject": "Behavioral Sciences",
      "system": "Social Sciences"
    },
    {
      "lecture": "Behavioral Science â€º Decision-Making Capacity",
      "duration": "13m",
      "subject": "Behavioral Sciences",
      "system": "Social Sciences"
    },
    {
      "lecture": "Behavioral Science â€º Public Health",
      "duration": "21m",
      "subject": "Behavioral Sciences",
      "system": "Social Sciences"
    },
    {
      "lecture": "Behavioral Science â€º Quality",
      "duration": "17m",
      "subject": "Behavioral Sciences",
      "system": "Social Sciences"
    },
    {
      "lecture": "Behavioral Science â€º Safety",
      "duration": "24m",
      "subject": "Behavioral Sciences",
      "system": "Social Sciences"
    },
    {
      "lecture": "Behavioral Science â€º Delivering Bad News",
      "duration": "10m",
      "subject": "Behavioral Sciences",
      "system": "Social Sciences"
    },
    {
      "lecture": "Cardiology â€º EKG Interpretation",
      "duration": "24m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º ACLS and Tachycardias",
      "duration": "26m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Atrial Fibrillation and Flutter",
      "duration": "23m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Bradycardia",
      "duration": "21m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Coronary Artery Disease",
      "duration": "27m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º STEMI",
      "duration": "22m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Heart Failure I",
      "duration": "18m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Heart Failure II",
      "duration": "19m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Cardiomyopathy",
      "duration": "29m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Heart Murmurs",
      "duration": "17m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Heart Sounds",
      "duration": "14m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Cardiovascular Pharmacology I",
      "duration": "25m",
      "subject": "Pharmacology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Cardiovascular Pharmacology II",
      "duration": "25m",
      "subject": "Pharmacology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Pericardial Disease",
      "duration": "24m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Valvular Heart Disease",
      "duration": "28m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Hyperlipidemia",
      "duration": "25m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Hypertension",
      "duration": "12m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Peripheral Vascular Disease",
      "duration": "23m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Cardiology â€º Aortic Disease",
      "duration": "14m",
      "subject": "Pathology",
      "system": "Cardiovascular System"
    },
    {
      "lecture": "Emergency Medicine â€º Burns",
      "duration": "12m",
      "subject": "Emergency Medicine",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Emergency Medicine â€º Toxicology",
      "duration": "21m",
      "subject": "Emergency Medicine",
      "system": "Poisoning and Environmental Exposure"
    },
    {
      "lecture": "Emergency Medicine â€º Common Emergencies",
      "duration": "21m",
      "subject": "Emergency Medicine",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Emergency Medicine â€º Chest Pain and Dyspnea",
      "duration": "10m",
      "subject": "Emergency Medicine",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Emergency Medicine â€º Trauma Basics",
      "duration": "14m",
      "subject": "Emergency Medicine",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Emergency Medicine â€º Neck and Spinal Injury",
      "duration": "15m",
      "subject": "Emergency Medicine",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Emergency Medicine â€º Chest Trauma",
      "duration": "15m",
      "subject": "Emergency Medicine",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Emergency Medicine â€º Abdominal Trauma",
      "duration": "12m",
      "subject": "Emergency Medicine",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Emergency Medicine â€º Pelvic Trauma",
      "duration": "13m",
      "subject": "Emergency Medicine",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Emergency Medicine â€º Fractures",
      "duration": "12m",
      "subject": "Emergency Medicine",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Endocrinology â€º Thyroid Hormone",
      "duration": "18m",
      "subject": "Pathology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Hypothyroidism",
      "duration": "29m",
      "subject": "Pathology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Hyperthyroidism",
      "duration": "24m",
      "subject": "Pathology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Thyroid Nodules",
      "duration": "16m",
      "subject": "Pathology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Hyperaldosteronism",
      "duration": "12m",
      "subject": "Pathology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Cushing Syndrome",
      "duration": "23m",
      "subject": "Pathology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Adrenal Insufficiency",
      "duration": "23m",
      "subject": "Pathology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Diabetes Mellitus",
      "duration": "16m",
      "subject": "Pathology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Diabetes Complications",
      "duration": "15m",
      "subject": "Pathology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Diabetic Ketoacidosis",
      "duration": "16m",
      "subject": "Pathology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Insulin",
      "duration": "10m",
      "subject": "Pathology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Diabetes Treatment",
      "duration": "20m",
      "subject": "Pharmacology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Pituitary Gland",
      "duration": "25m",
      "subject": "Anatomy and Physiology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Hyperparathyroidism",
      "duration": "23m",
      "subject": "Pathology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Hypoparathyroidism and Vitamin D",
      "duration": "19m",
      "subject": "Pathology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Endocrinology â€º Osteoporosis",
      "duration": "19m",
      "subject": "Pathology",
      "system": "Endocrine Diabetes Metabolism"
    },
    {
      "lecture": "Epidemiology â€º Statistics",
      "duration": "18m",
      "subject": "Epidemiology and Biostatistics",
      "system": "Social Sciences"
    },
    {
      "lecture": "Epidemiology â€º Hypothesis Testing",
      "duration": "22m",
      "subject": "Epidemiology and Biostatistics",
      "system": "Social Sciences"
    },
    {
      "lecture": "Epidemiology â€º Tests of Significance",
      "duration": "15m",
      "subject": "Epidemiology and Biostatistics",
      "system": "Social Sciences"
    },
    {
      "lecture": "Epidemiology â€º Correlations",
      "duration": "8m",
      "subject": "Epidemiology and Biostatistics",
      "system": "Social Sciences"
    },
    {
      "lecture": "Epidemiology â€º Study Designs",
      "duration": "19m",
      "subject": "Epidemiology and Biostatistics",
      "system": "Social Sciences"
    },
    {
      "lecture": "Epidemiology â€º Risk Quantification",
      "duration": "20m",
      "subject": "Epidemiology and Biostatistics",
      "system": "Social Sciences"
    },
    {
      "lecture": "Epidemiology â€º Sensitivity and Specificity",
      "duration": "21m",
      "subject": "Epidemiology and Biostatistics",
      "system": "Social Sciences"
    },
    {
      "lecture": "Epidemiology â€º Predictive Value",
      "duration": "12m",
      "subject": "Epidemiology and Biostatistics",
      "system": "Social Sciences"
    },
    {
      "lecture": "Epidemiology â€º Diagnostic Tests",
      "duration": "17m",
      "subject": "Epidemiology and Biostatistics",
      "system": "Social Sciences"
    },
    {
      "lecture": "Epidemiology â€º Bias",
      "duration": "23m",
      "subject": "Epidemiology and Biostatistics",
      "system": "Social Sciences"
    },
    {
      "lecture": "Epidemiology â€º Clinical trials",
      "duration": "32m",
      "subject": "Epidemiology and Biostatistics",
      "system": "Social Sciences"
    },
    {
      "lecture": "Epidemiology â€º Evidence Based Medicine",
      "duration": "10m",
      "subject": "Epidemiology and Biostatistics",
      "system": "Social Sciences"
    },
    {
      "lecture": "Gastroenterology â€º Esophageal Disorders",
      "duration": "28m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º GERD and Esophageal Cancer",
      "duration": "21m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Gastric Disorders",
      "duration": "23m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Gastric Cancer",
      "duration": "13m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Liver Disease",
      "duration": "25m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Liver Masses",
      "duration": "15m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Cirrhosis",
      "duration": "27m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Viral Hepatitis",
      "duration": "24m",
      "subject": "Pathology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Gastroenterology â€º Hyperbilirubinemia",
      "duration": "20m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Wilson's Disease",
      "duration": "7m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Hemochromatosis",
      "duration": "11m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Biliary Disease",
      "duration": "16m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Gallstone Disease",
      "duration": "25m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Pancreatic Cancer",
      "duration": "9m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Pancreatitis",
      "duration": "23m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Colon Cancer",
      "duration": "21m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Colorectal Disease",
      "duration": "20m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Small Bowel Disease",
      "duration": "25m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Inflammatory Bowel Disease",
      "duration": "20m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Diarrhea",
      "duration": "22m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Gastrointestinal Bleeding",
      "duration": "17m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Hernias",
      "duration": "18m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Malabsorption",
      "duration": "20m",
      "subject": "Pathology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Gastroenterology â€º Gastrointestinal Pharmacology",
      "duration": "14m",
      "subject": "Pharmacology",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Hematology and Oncology â€º Normocytic Anemias",
      "duration": "22m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Microcytic Anemias",
      "duration": "25m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Thalassemias",
      "duration": "25m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Macrocytic Anemias",
      "duration": "16m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Extrinsic Hemolysis",
      "duration": "20m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Intrinsic Hemolysis",
      "duration": "18m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Sickle Cell Disease",
      "duration": "23m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Blood Products",
      "duration": "27m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Thrombocytopenia",
      "duration": "22m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Coagulopathy",
      "duration": "25m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Hypercoagulable States",
      "duration": "20m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Antiplatelet Drugs",
      "duration": "10m",
      "subject": "Pharmacology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Anticoagulants",
      "duration": "25m",
      "subject": "Pharmacology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Plasma Cell Disorders",
      "duration": "18m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Myeloproliferative Disorders",
      "duration": "18m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Acute Leukemias",
      "duration": "23m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Chronic Leukemias",
      "duration": "15m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Hodgkin Lymphoma",
      "duration": "10m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Non-Hodgkin Lymphoma",
      "duration": "20m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Hematology and Oncology â€º Amyloidosis",
      "duration": "19m",
      "subject": "Pathology",
      "system": "Hematology and Oncology"
    },
    {
      "lecture": "Infectious Disease â€º Penicillins",
      "duration": "24m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º Beta Lactams",
      "duration": "16m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º Protein Synthesis Inhibitors",
      "duration": "15m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º Other Antibiotics",
      "duration": "23m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º Fungal Infections",
      "duration": "25m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º Antifungal Drugs",
      "duration": "12m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º Protazoal Infections",
      "duration": "20m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º Malaria",
      "duration": "15m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º HIV Infection",
      "duration": "24m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º HIV Drugs",
      "duration": "16m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º HIV Complications",
      "duration": "22m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º Tick-borne Illnesses",
      "duration": "16m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º Sexually-transmitted Infections",
      "duration": "23m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º Meningitis",
      "duration": "25m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º Tuberculosis",
      "duration": "18m",
      "subject": "Pharmacology",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Infectious Disease â€º Adult Vaccinations",
      "duration": "20m",
      "subject": "Professional Practice",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Musculoskeletal â€º Arthritis I",
      "duration": "21m",
      "subject": "Pathology",
      "system": "Rheumatology Musculoskeletal System"
    },
    {
      "lecture": "Musculoskeletal â€º Arthritis II",
      "duration": "15m",
      "subject": "Pathology",
      "system": "Rheumatology Musculoskeletal System"
    },
    {
      "lecture": "Musculoskeletal â€º Gout",
      "duration": "22m",
      "subject": "Pathology",
      "system": "Rheumatology Musculoskeletal System"
    },
    {
      "lecture": "Musculoskeletal â€º Systemic Lupus Erythematosus",
      "duration": "14m",
      "subject": "Pathology",
      "system": "Rheumatology Musculoskeletal System"
    },
    {
      "lecture": "Musculoskeletal â€º Scleroderma and Sjogren's",
      "duration": "16m",
      "subject": "Pathology",
      "system": "Rheumatology Musculoskeletal System"
    },
    {
      "lecture": "Musculoskeletal â€º Vasculitis",
      "duration": "24m",
      "subject": "Pathology",
      "system": "Rheumatology Musculoskeletal System"
    },
    {
      "lecture": "Musculoskeletal â€º Spondyloarthritis",
      "duration": "14m",
      "subject": "Pathology",
      "system": "Rheumatology Musculoskeletal System"
    },
    {
      "lecture": "Musculoskeletal â€º Muscle Disorders",
      "duration": "12m",
      "subject": "Pathology",
      "system": "Rheumatology Musculoskeletal System"
    },
    {
      "lecture": "Musculoskeletal â€º Low Back Pain",
      "duration": "32m",
      "subject": "Pathology",
      "system": "Rheumatology Musculoskeletal System"
    },
    {
      "lecture": "Neurology â€º Stroke I",
      "duration": "21m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Stroke II",
      "duration": "19m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Intracranial Bleeding",
      "duration": "15m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Seizures",
      "duration": "20m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Seizure Treatment",
      "duration": "16m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Parkinsonâ€™s Disease",
      "duration": "18m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Movement Disorders",
      "duration": "17m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Multiple Sclerosis",
      "duration": "19m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Demyelinating Disorders",
      "duration": "12m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Cerebellar Disorders",
      "duration": "13m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Spinal Cord Disorders",
      "duration": "27m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Neuromuscular Disease",
      "duration": "22m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Intracranial Hypertension",
      "duration": "17m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Ventricular Pathology",
      "duration": "11m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Dementia",
      "duration": "29m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Altered Mental Status",
      "duration": "17m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Traumatic Brain Injury",
      "duration": "14m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Headache",
      "duration": "17m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Syncope",
      "duration": "20m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Vertigo",
      "duration": "15m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º CNS Malignancy",
      "duration": "19m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Neurology â€º Congenital Neurology",
      "duration": "14m",
      "subject": "Pathology",
      "system": "Nervous System"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Normal Pregnancy",
      "duration": "24m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Prenatal Care",
      "duration": "17m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Aneuploidy Screening",
      "duration": "11m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Antepartum Fetal Surveillance",
      "duration": "9m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Teratogens",
      "duration": "20m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º TORCH Infections",
      "duration": "23m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Perinatal Infections",
      "duration": "10m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Abortion",
      "duration": "18m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Ectopic Pregnancy",
      "duration": "9m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Gestational Trophoblastic Disease",
      "duration": "15m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Placental Pathology",
      "duration": "18m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Multiple Gestation",
      "duration": "8m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Labor and Delivery I",
      "duration": "11m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Labor and Delivery II",
      "duration": "24m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Intrapartum Fetal Monitoring",
      "duration": "10m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Preterm Labor",
      "duration": "13m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Labor and Delivery Complications",
      "duration": "23m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Maternal Pregnancy Complications",
      "duration": "14m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Hypertension in Pregnancy",
      "duration": "18m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Postpartum",
      "duration": "22m",
      "subject": "Ob/Gyn",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Menstrual Cycle",
      "duration": "21m",
      "subject": "Ob/Gyn",
      "system": "Female Reproductive System and Breast"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Contraception",
      "duration": "20m",
      "subject": "Ob/Gyn",
      "system": "Female Reproductive System and Breast"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Primary Amenorrhea",
      "duration": "21m",
      "subject": "Ob/Gyn",
      "system": "Female Reproductive System and Breast"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Secondary Amenorrhea",
      "duration": "21m",
      "subject": "Ob/Gyn",
      "system": "Female Reproductive System and Breast"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Dysmenorrhea",
      "duration": "19m",
      "subject": "Ob/Gyn",
      "system": "Female Reproductive System and Breast"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Abnormal Uterine Bleeding",
      "duration": "13m",
      "subject": "Ob/Gyn",
      "system": "Female Reproductive System and Breast"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Vaginitis",
      "duration": "12m",
      "subject": "Ob/Gyn",
      "system": "Female Reproductive System and Breast"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Pelvic Inflammatory Disease",
      "duration": "8m",
      "subject": "Ob/Gyn",
      "system": "Female Reproductive System and Breast"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Cervical Cancer",
      "duration": "23m",
      "subject": "Ob/Gyn",
      "system": "Female Reproductive System and Breast"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Uterine Cancer",
      "duration": "24m",
      "subject": "Ob/Gyn",
      "system": "Female Reproductive System and Breast"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Adnexal Mass",
      "duration": "11m",
      "subject": "Ob/Gyn",
      "system": "Female Reproductive System and Breast"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Ovarian Neoplasia",
      "duration": "15m",
      "subject": "Ob/Gyn",
      "system": "Female Reproductive System and Breast"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Breast Masses",
      "duration": "24m",
      "subject": "Ob/Gyn",
      "system": "Female Reproductive System and Breast"
    },
    {
      "lecture": "Obstetrics and Gynecology â€º Breast Cancer",
      "duration": "29m",
      "subject": "Ob/Gyn",
      "system": "Female Reproductive System and Breast"
    },
    {
      "lecture": "Pediatrics â€º Delivery Room Care",
      "duration": "15m",
      "subject": "Pediatrics",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Pediatrics â€º Newborn Nursery",
      "duration": "15m",
      "subject": "Pediatrics",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Pediatrics â€º Preterm and Postterm Infants",
      "duration": "24m",
      "subject": "Pediatrics",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Pediatrics â€º Newborn Hyperbilirubinemia",
      "duration": "13m",
      "subject": "Pediatrics",
      "system": "Pregnancy Childbirth and Puerperium"
    },
    {
      "lecture": "Pediatrics â€º Developmental Milestones",
      "duration": "17m",
      "subject": "Pediatrics",
      "system": "General Embryology"
    },
    {
      "lecture": "Pediatrics â€º Pediatric Screening",
      "duration": "9m",
      "subject": "Pediatrics",
      "system": "General Embryology"
    },
    {
      "lecture": "Pediatrics â€º General Pediatrics",
      "duration": "21m",
      "subject": "Pediatrics",
      "system": "General Embryology"
    },
    {
      "lecture": "Pediatrics â€º Adolescent Medicine",
      "duration": "11m",
      "subject": "Pediatrics",
      "system": "Miscellaneous Multisystem"
    },
    {
      "lecture": "Pediatrics â€º Ear Infections and Fevers",
      "duration": "18m",
      "subject": "Pediatrics",
      "system": "ENT"
    },
    {
      "lecture": "Pediatrics â€º Pediatric Rashes",
      "duration": "21m",
      "subject": "Pediatrics",
      "system": "Dermatology"
    },
    {
      "lecture": "Pediatrics â€º Vaccination",
      "duration": "28m",
      "subject": "Pediatrics",
      "system": "Multisystemic Infectious Diseases"
    },
    {
      "lecture": "Pediatrics â€º Child Abuse",
      "duration": "7m",
      "subject": "Pediatrics",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Pediatrics â€º Pediatric Orthopedics",
      "duration": "19m",
      "subject": "Pediatrics",
      "system": "Rheumatology Musculoskeletal System"
    },
    {
      "lecture": "Pediatrics â€º Child Psychology",
      "duration": "20m",
      "subject": "Pediatrics",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Pediatrics â€º Congenital Gastroenterology I",
      "duration": "16m",
      "subject": "Pediatrics",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Pediatrics â€º Congenital Gastroenterology II",
      "duration": "23m",
      "subject": "Pediatrics",
      "system": "Gastrointestinal and Nutrition"
    },
    {
      "lecture": "Psychiatry â€º Defense Mechanisms",
      "duration": "9m",
      "subject": "Psychiatry",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Psychiatry â€º Psychotic Disorders",
      "duration": "15m",
      "subject": "Psychiatry",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Psychiatry â€º Mania",
      "duration": "16m",
      "subject": "Psychiatry",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Psychiatry â€º Depression",
      "duration": "19m",
      "subject": "Psychiatry",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Psychiatry â€º Anxiety Disorders",
      "duration": "15m",
      "subject": "Psychiatry",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Psychiatry â€º Personality Disorders",
      "duration": "13m",
      "subject": "Psychiatry",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Psychiatry â€º Dissociative Disorders",
      "duration": "6m",
      "subject": "Psychiatry",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Psychiatry â€º Somatic Disorders",
      "duration": "8m",
      "subject": "Psychiatry",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Psychiatry â€º Eating Disorders",
      "duration": "11m",
      "subject": "Psychiatry",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Psychiatry â€º Alcohol Use Disorder",
      "duration": "16m",
      "subject": "Psychiatry",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Psychiatry â€º Substance Abuse I",
      "duration": "16m",
      "subject": "Psychiatry",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Psychiatry â€º Substance Abuse II",
      "duration": "12m",
      "subject": "Psychiatry",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Psychiatry â€º Antidepressants",
      "duration": "19m",
      "subject": "Pharmacology",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Psychiatry â€º Antipsychotics",
      "duration": "21m",
      "subject": "Pharmacology",
      "system": "Psychiatric Behavioral and Substance Abuse"
    },
    {
      "lecture": "Pulmonary Critical Care â€º Pulmonary Function Tests",
      "duration": "13m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Pulmonary Critical Care â€º Asthma",
      "duration": "18m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Pulmonary Critical Care â€º COPD Diagnosis",
      "duration": "19m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Pulmonary Critical Care â€º COPD Treatment",
      "duration": "15m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Pulmonary Critical Care â€º Restrictive Lung Disease",
      "duration": "21m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Pulmonary Critical Care â€º Pneumonia",
      "duration": "16m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Pulmonary Critical Care â€º Lung Cancer",
      "duration": "19m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Pulmonary Critical Care â€º Bronchiectasis",
      "duration": "10m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Pulmonary Critical Care â€º Shock",
      "duration": "25m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Pulmonary Critical Care â€º Respiratory Failure",
      "duration": "29m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Pulmonary Critical Care â€º Sepsis ARDS",
      "duration": "14m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Pulmonary Critical Care â€º Pulmonary Hypertension",
      "duration": "16m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Pulmonary Critical Care â€º DVT and Pulmonary Embolism",
      "duration": "22m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Pulmonary Critical Care â€º Pleural Disease",
      "duration": "23m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Pulmonary Critical Care â€º Cystic Fibrosis",
      "duration": "10m",
      "subject": "Pathology",
      "system": "Pulmonary and Critical Care"
    },
    {
      "lecture": "Renal & Genitourinary â€º Acute Renal Failure",
      "duration": "26m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Chronic Kidney Disease",
      "duration": "19m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Fluids",
      "duration": "13m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Hyponatremia",
      "duration": "25m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Hypernatremia",
      "duration": "12m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Potassium Disorders",
      "duration": "13m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Calcium, Magnesium, and Phosphate Disorders",
      "duration": "21m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Acid Base Principles",
      "duration": "22m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Metabolic Acidosis",
      "duration": "25m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Metabolic Alkalosis",
      "duration": "17m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Respiratory Acid Base Disorders",
      "duration": "12m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Renal Tubular Acidosis",
      "duration": "23m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Nephritic Syndrome",
      "duration": "18m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Nephrotic Syndrome",
      "duration": "27m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º RPGN",
      "duration": "10m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Nephrolithiasis",
      "duration": "19m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Hematuria",
      "duration": "9m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Urinary Infections",
      "duration": "12m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Urinary Incontinence",
      "duration": "7m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Tubulointerstitial Disorders",
      "duration": "14m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Cystic Kidney Disease",
      "duration": "6m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Urinary Tract Malignancy",
      "duration": "13m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Diuretics",
      "duration": "21m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Renal & Genitourinary â€º Rhabdomyolysis",
      "duration": "8m",
      "subject": "Pathology",
      "system": "Renal Urinary Systems and Electrolytes"
    },
    {
      "lecture": "Surgery & Anesthesia â€º Pre-operative Evaluation",
      "duration": "22m",
      "subject": "Surgery",
      "system": "Miscellaneous Multisystem"
    },
    {
      "lecture": "Surgery & Anesthesia â€º Post-operative Complications",
      "duration": "20m",
      "subject": "Surgery",
      "system": "Miscellaneous Multisystem"
    },
    {
      "lecture": "Surgery & Anesthesia â€º General Anesthesia",
      "duration": "19m",
      "subject": "Pharmacology",
      "system": "Nervous System"
    },
    {
      "lecture": "Surgery & Anesthesia â€º Intravenous Anesthetics",
      "duration": "15m",
      "subject": "Pharmacology",
      "system": "Nervous System"
    },
    {
      "lecture": "Surgery & Anesthesia â€º Neuromuscular Blockers",
      "duration": "18m",
      "subject": "Pharmacology",
      "system": "Nervous System"
    },
    {
      "lecture": "Surgery & Anesthesia â€º Regional and Local Anesthesia",
      "duration": "13m",
      "subject": "Pharmacology",
      "system": "Nervous System"
    }
  ],
  "metadata": {
    "totalLectures": 265,
    "totalDuration": 4784,
    "subjects": [
      "Behavioral Sciences",
      "Pathology",
      "Pharmacology",
      "Emergency Medicine",
      "Anatomy and Physiology",
      "Epidemiology and Biostatistics",
      "Professional Practice",
      "Ob/Gyn",
      "Pediatrics",
      "Psychiatry",
      "Surgery"
    ],
    "systems": [
      "Social Sciences",
      "Cardiovascular System",
      "Pulmonary and Critical Care",
      "Poisoning and Environmental Exposure",
      "Endocrine Diabetes Metabolism",
      "Gastrointestinal and Nutrition",
      "Multisystemic Infectious Diseases",
      "Hematology and Oncology",
      "Rheumatology Musculoskeletal System",
      "Nervous System",
      "Pregnancy Childbirth and Puerperium",
      "Female Reproductive System and Breast",
      "General Embryology",
      "Miscellaneous Multisystem",
      "ENT",
      "Dermatology",
      "Psychiatric Behavioral and Substance Abuse",
      "Renal Urinary Systems and Electrolytes"
    ]
  }
};

        let scheduleData = [];
        let organizationOrder = [];
        let removedItems = new Set();

        // Inicializar a lista de organizaÃ§Ã£o
        function initializeOrganizationList() {
            const orgType = document.querySelector('input[name="organization"]:checked').value;
            const uniqueItems = [...new Set(courseData.lectures.map(l => l[orgType]))];
            
            organizationOrder = uniqueItems.sort();
            removedItems.clear();
            renderOrganizationList();
        }

        function renderOrganizationList() {
            const container = document.getElementById('organizationList');
            const orgType = document.querySelector('input[name="organization"]:checked').value;
            
            let html = `
                <div style="margin-top: 20px;">
                    <label style="margin-bottom: 10px; display: block;">
                        ðŸŽ¯ Arraste para reordenar ou clique no X para remover ${orgType === 'subject' ? 'Subjects' : 'Systems'}:
                    </label>
                    <ul class="sortable-list" id="sortableList">
            `;
            
            organizationOrder.forEach((item, index) => {
                const isRemoved = removedItems.has(item);
                html += `
                    <li class="sortable-item ${isRemoved ? 'removed' : ''}" draggable="${!isRemoved}" data-item="${item}">
                        <span>${item}</span>
                        <div class="item-controls">
                            ${!isRemoved ? 
                                `<span class="item-handle">â˜°</span>
                                 <span class="item-remove" onclick="toggleItem('${item}')">âœ•</span>` :
                                `<span class="item-restore" onclick="toggleItem('${item}')">Restaurar</span>`
                            }
                        </div>
                    </li>
                `;
            });
            
            html += `
                    </ul>
                </div>
            `;
            
            container.innerHTML = html;
            
            // Adicionar funcionalidade de drag and drop
            const sortableList = document.getElementById('sortableList');
            let draggedElement = null;
            
            sortableList.addEventListener('dragstart', (e) => {
                if (e.target.classList.contains('sortable-item') && !e.target.classList.contains('removed')) {
                    draggedElement = e.target;
                    e.target.classList.add('dragging');
                }
            });
            
            sortableList.addEventListener('dragend', (e) => {
                if (e.target.classList.contains('sortable-item')) {
                    e.target.classList.remove('dragging');
                }
            });
            
            sortableList.addEventListener('dragover', (e) => {
                e.preventDefault();
                const afterElement = getDragAfterElement(sortableList, e.clientY);
                if (draggedElement && afterElement == null) {
                    sortableList.appendChild(draggedElement);
                } else if (draggedElement && afterElement) {
                    sortableList.insertBefore(draggedElement, afterElement);
                }
            });
            
            sortableList.addEventListener('drop', (e) => {
                e.preventDefault();
                updateOrganizationOrder();
            });
        }

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.sortable-item:not(.dragging):not(.removed)')];
            
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        function updateOrganizationOrder() {
            const items = document.querySelectorAll('.sortable-item');
            organizationOrder = Array.from(items).map(item => item.dataset.item);
        }

        function toggleItem(item) {
            if (removedItems.has(item)) {
                removedItems.delete(item);
            } else {
                removedItems.add(item);
            }
            renderOrganizationList();
        }

        function generateSchedule() {
            const studentName = document.getElementById('studentName').value;
            const startDate = new Date(document.getElementById('startDate').value);
            const endDate = new Date(document.getElementById('endDate').value);
            
            if (!studentName || !startDate || !endDate) {
                alert('Por favor, preencha todos os campos!');
                return;
            }
            
            if (startDate >= endDate) {
                alert('A data de tÃ©rmino deve ser posterior Ã  data de inÃ­cio!');
                return;
            }
            
            // Obter dias off selecionados
            const daysOff = [];
            document.querySelectorAll('.weekday-checkbox:checked').forEach(checkbox => {
                daysOff.push(parseInt(checkbox.value));
            });
            
            document.querySelector('.loading').classList.add('active');
            
            setTimeout(() => {
                // Calcular dias disponÃ­veis para estudo
                let studyDays = [];
                let currentDate = new Date(startDate);
                
                while (currentDate <= endDate) {
                    const dayOfWeek = currentDate.getDay();
                    if (!daysOff.includes(dayOfWeek)) {
                        studyDays.push(new Date(currentDate));
                    }
                    currentDate.setDate(currentDate.getDate() + 1);
                }
                
                if (studyDays.length === 0) {
                    alert('NÃ£o hÃ¡ dias disponÃ­veis para estudo! Verifique as datas e os days off.');
                    document.querySelector('.loading').classList.remove('active');
                    return;
                }
                
                // Filtrar aulas baseado nos itens removidos
                const orgType = document.querySelector('input[name="organization"]:checked').value;
                const filteredLectures = courseData.lectures.filter(lecture => 
                    !removedItems.has(lecture[orgType])
                );
                
                // Ordenar aulas baseado na ordem definida pelo usuÃ¡rio
                const sortedLectures = filteredLectures.sort((a, b) => {
                    const indexA = organizationOrder.indexOf(a[orgType]);
                    const indexB = organizationOrder.indexOf(b[orgType]);
                    
                    if (indexA !== indexB) {
                        return indexA - indexB;
                    }
                    // Se for o mesmo subject/system, manter ordem original
                    return filteredLectures.indexOf(a) - filteredLectures.indexOf(b);
                });
                
                // Calcular distribuiÃ§Ã£o de aulas
                const totalLectures = sortedLectures.length;
                const avgLecturesPerDay = totalLectures / studyDays.length;
                const baseLecturesPerDay = Math.floor(avgLecturesPerDay);
                const extraLectures = totalLectures % studyDays.length;
                
                // Distribuir aulas pelos dias
                scheduleData = [];
                let lectureIndex = 0;
                
                for (let i = 0; i < studyDays.length && lectureIndex < totalLectures; i++) {
                    const date = studyDays[i];
                    const weekNumber = Math.floor((date - startDate) / (1000 * 60 * 60 * 24 * 7)) + 1;
                    
                    // Determinar quantas aulas para este dia
                    const lecturesForToday = baseLecturesPerDay + (i < extraLectures ? 1 : 0);
                    
                    for (let j = 0; j < lecturesForToday && lectureIndex < totalLectures; j++) {
                        const lecture = sortedLectures[lectureIndex];
                        scheduleData.push({
                            week: `Semana ${weekNumber}`,
                            weekNumber: weekNumber,
                            date: formatDate(date),
                            dayOfWeek: getDayName(date.getDay()),
                            subject: lecture.subject,
                            system: lecture.system,
                            lecture: lecture.lecture,
                            duration: lecture.duration,
                            status: '',
                            notes: ''
                        });
                        lectureIndex++;
                    }
                }
                
                displayPreview(studyDays.length, daysOff.length, totalLectures);
                document.getElementById('downloadBtn').disabled = false;
                document.querySelector('.loading').classList.remove('active');
            }, 1000);
        }
        
        function getDayName(dayNumber) {
            const days = ['Domingo', 'Segunda', 'TerÃ§a', 'Quarta', 'Quinta', 'Sexta', 'SÃ¡bado'];
            return days[dayNumber];
        }
        
        function formatDate(date) {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
        }
        
        function displayPreview(studyDaysCount, daysOffPerWeek, totalLectures) {
            const previewContainer = document.getElementById('previewContainer');
            const statsGrid = document.getElementById('statsGrid');
            const previewTable = document.getElementById('previewTable');
            
            // Exibir estatÃ­sticas
            const avgLecturesPerDay = (totalLectures / studyDaysCount).toFixed(1);
            
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${studyDaysCount}</div>
                    <div class="stat-label">Dias de Estudo</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${totalLectures}</div>
                    <div class="stat-label">Total de Aulas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${avgLecturesPerDay}</div>
                    <div class="stat-label">MÃ©dia de Aulas/Dia</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${7 - daysOffPerWeek}</div>
                    <div class="stat-label">Dias/Semana</div>
                </div>
            `;
            
            // Exibir tabela
            let html = '<table class="preview-table">';
            html += '<thead><tr>';
            html += '<th>Semana</th>';
            html += '<th>Dia</th>';
            html += '<th>Data</th>';
            html += '<th>Subject</th>';
            html += '<th>System</th>';
            html += '<th>Aula</th>';
            html += '<th>DuraÃ§Ã£o</th>';
            html += '</tr></thead>';
            html += '<tbody>';
            
            const limitedData = scheduleData.slice(0, 50);
            
            limitedData.forEach(row => {
                const weekClass = `week-${((row.weekNumber - 1) % 4) + 1}`;
                html += `<tr class="${weekClass}">`;
                html += `<td>${row.week}</td>`;
                html += `<td>${row.dayOfWeek}</td>`;
                html += `<td>${row.date}</td>`;
                html += `<td>${row.subject}</td>`;
                html += `<td>${row.system}</td>`;
                html += `<td>${row.lecture}</td>`;
                html += `<td>${row.duration}</td>`;
                html += '</tr>';
            });
            
            html += '</tbody></table>';
            
            if (scheduleData.length > 50) {
                html += `<p style="text-align: center; margin-top: 20px; color: #6b7280;">
                    Mostrando apenas as primeiras 50 aulas. Baixe o Excel para ver o cronograma completo.
                </p>`;
            }
            
            previewTable.innerHTML = html;
            previewContainer.classList.add('active');
        }
        
        function downloadExcel() {
            const studentName = document.getElementById('studentName').value;
            const wb = XLSX.utils.book_new();
            
            // Adicionar cabeÃ§alho com a marca
            const headerData = [
                ['WARD ACADEMY - De Old para Old'],
                [`Cronograma USMLE Step 2 CK - ${studentName}`],
                [`Gerado em: ${new Date().toLocaleDateString('pt-BR')}`],
                [], // Linha vazia
                ['Semana', 'Dia da Semana', 'Data', 'Subject', 'System', 'Aulas', 'DuraÃ§Ã£o', 'Status', 'AnotaÃ§Ãµes']
            ];
            
            // Preparar dados para Excel
            const wsData = [...headerData];
            
            scheduleData.forEach(row => {
                wsData.push([
                    row.week,
                    row.dayOfWeek,
                    row.date,
                    row.subject,
                    row.system,
                    row.lecture,
                    row.duration,
                    '',
                    ''
                ]);
            });
            
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            
            // Configurar mesclagem de cÃ©lulas para o cabeÃ§alho
            ws['!merges'] = [
                // Mesclar tÃ­tulo principal
                { s: { r: 0, c: 0 }, e: { r: 0, c: 8 } },
                // Mesclar subtÃ­tulo
                { s: { r: 1, c: 0 }, e: { r: 1, c: 8 } },
                // Mesclar data de geraÃ§Ã£o
                { s: { r: 2, c: 0 }, e: { r: 2, c: 8 } }
            ];
            
            // Mesclar cÃ©lulas de Semana
            let currentWeek = '';
            let weekStartRow = 5; // ComeÃ§a apÃ³s o cabeÃ§alho
            
            for (let i = 0; i < scheduleData.length; i++) {
                const rowData = scheduleData[i];
                const excelRow = i + 5; // +5 por causa do cabeÃ§alho
                
                if (rowData.week !== currentWeek) {
                    if (currentWeek !== '' && excelRow > weekStartRow) {
                        ws['!merges'].push({
                            s: { r: weekStartRow, c: 0 },
                            e: { r: excelRow - 1, c: 0 }
                        });
                    }
                    currentWeek = rowData.week;
                    weekStartRow = excelRow;
                }
            }
            
            // Ãšltima mesclagem de semana
            if (weekStartRow < scheduleData.length + 4) {
                ws['!merges'].push({
                    s: { r: weekStartRow, c: 0 },
                    e: { r: scheduleData.length + 4, c: 0 }
                });
            }
            
            // Mesclar cÃ©lulas de Dia da Semana e Data
            let currentDay = '';
            let currentDate = '';
            let dayStartRow = 5;
            let dateStartRow = 5;
            
            for (let i = 0; i < scheduleData.length; i++) {
                const rowData = scheduleData[i];
                const excelRow = i + 5;
                
                // Mesclar Dia da Semana
                if (rowData.dayOfWeek !== currentDay || rowData.date !== currentDate) {
                    if (currentDay !== '' && excelRow > dayStartRow) {
                        ws['!merges'].push({
                            s: { r: dayStartRow, c: 1 },
                            e: { r: excelRow - 1, c: 1 }
                        });
                    }
                    currentDay = rowData.dayOfWeek;
                    dayStartRow = excelRow;
                }
                
                // Mesclar Data
                if (rowData.date !== currentDate) {
                    if (currentDate !== '' && excelRow > dateStartRow) {
                        ws['!merges'].push({
                            s: { r: dateStartRow, c: 2 },
                            e: { r: excelRow - 1, c: 2 }
                        });
                    }
                    currentDate = rowData.date;
                    dateStartRow = excelRow;
                }
            }
            
            // Ãšltimas mesclagens de dia e data
            if (dayStartRow < scheduleData.length + 4) {
                ws['!merges'].push({
                    s: { r: dayStartRow, c: 1 },
                    e: { r: scheduleData.length + 4, c: 1 }
                });
            }
            
            if (dateStartRow < scheduleData.length + 4) {
                ws['!merges'].push({
                    s: { r: dateStartRow, c: 2 },
                    e: { r: scheduleData.length + 4, c: 2 }
                });
            }
            
            // Mesclar cÃ©lulas de Subject e System quando consecutivos e iguais
            let currentSubject = '';
            let currentSystem = '';
            let subjectStartRow = 5;
            let systemStartRow = 5;
            
            for (let i = 0; i < scheduleData.length; i++) {
                const rowData = scheduleData[i];
                const excelRow = i + 5;
                
                // Mesclar Subject
                if (rowData.subject !== currentSubject) {
                    if (currentSubject !== '' && excelRow > subjectStartRow) {
                        ws['!merges'].push({
                            s: { r: subjectStartRow, c: 3 },
                            e: { r: excelRow - 1, c: 3 }
                        });
                    }
                    currentSubject = rowData.subject;
                    subjectStartRow = excelRow;
                }
                
                // Mesclar System
                if (rowData.system !== currentSystem) {
                    if (currentSystem !== '' && excelRow > systemStartRow) {
                        ws['!merges'].push({
                            s: { r: systemStartRow, c: 4 },
                            e: { r: excelRow - 1, c: 4 }
                        });
                    }
                    currentSystem = rowData.system;
                    systemStartRow = excelRow;
                }
            }
            
            // Ãšltimas mesclagens de subject e system
            if (subjectStartRow < scheduleData.length + 4) {
                ws['!merges'].push({
                    s: { r: subjectStartRow, c: 3 },
                    e: { r: scheduleData.length + 4, c: 3 }
                });
            }
            
            if (systemStartRow < scheduleData.length + 4) {
                ws['!merges'].push({
                    s: { r: systemStartRow, c: 4 },
                    e: { r: scheduleData.length + 4, c: 4 }
                });
            }
            
            // Configurar largura das colunas
            ws['!cols'] = [
                { wch: 12 },  // Semana
                { wch: 15 },  // Dia da Semana
                { wch: 12 },  // Data
                { wch: 30 },  // Subject
                { wch: 30 },  // System
                { wch: 50 },  // Aulas
                { wch: 10 },  // DuraÃ§Ã£o
                { wch: 10 },  // Status
                { wch: 30 }   // AnotaÃ§Ãµes
            ];
            
            // Aplicar estilos e cores
            const colors = {
                week1: 'E0F2FE',
                week2: 'F0FDF4', 
                week3: 'FEF3C7',
                week4: 'FCE7F3',
                header: '667EEA',
                title: '764BA2'
            };
            
            // Estilo do cabeÃ§alho principal
            for (let col = 0; col <= 8; col++) {
                // TÃ­tulo principal
                const titleCell = XLSX.utils.encode_cell({ r: 0, c: col });
                if (!ws[titleCell]) ws[titleCell] = { v: '' };
                ws[titleCell].s = {
                    font: { bold: true, color: { rgb: 'FFFFFF' }, sz: 16 },
                    fill: { fgColor: { rgb: colors.title } },
                    alignment: { horizontal: 'center', vertical: 'center' }
                };
                
                // SubtÃ­tulo
                const subtitleCell = XLSX.utils.encode_cell({ r: 1, c: col });
                if (!ws[subtitleCell]) ws[subtitleCell] = { v: '' };
                ws[subtitleCell].s = {
                    font: { bold: true, color: { rgb: 'FFFFFF' }, sz: 14 },
                    fill: { fgColor: { rgb: colors.header } },
                    alignment: { horizontal: 'center', vertical: 'center' }
                };
                
                // Data de geraÃ§Ã£o
                const dateCell = XLSX.utils.encode_cell({ r: 2, c: col });
                if (!ws[dateCell]) ws[dateCell] = { v: '' };
                ws[dateCell].s = {
                    font: { color: { rgb: '333333' }, sz: 11 },
                    fill: { fgColor: { rgb: 'F3F4F6' } },
                    alignment: { horizontal: 'center', vertical: 'center' }
                };
            }
            
            // Estilo do cabeÃ§alho da tabela
            for (let col = 0; col <= 8; col++) {
                const headerCell = XLSX.utils.encode_cell({ r: 4, c: col });
                if (!ws[headerCell]) ws[headerCell] = { v: '' };
                ws[headerCell].s = {
                    font: { bold: true, color: { rgb: 'FFFFFF' } },
                    fill: { fgColor: { rgb: colors.header } },
                    alignment: { horizontal: 'center', vertical: 'center' },
                    border: {
                        top: { style: 'thin', color: { rgb: '000000' } },
                        bottom: { style: 'thin', color: { rgb: '000000' } },
                        left: { style: 'thin', color: { rgb: '000000' } },
                        right: { style: 'thin', color: { rgb: '000000' } }
                    }
                };
            }
            
            // Aplicar cores alternadas por semana
            for (let i = 0; i < scheduleData.length; i++) {
                const rowData = scheduleData[i];
                const excelRow = i + 5;
                const weekNum = rowData.weekNumber;
                const colorIndex = ((weekNum - 1) % 4);
                const weekColors = [colors.week1, colors.week2, colors.week3, colors.week4];
                const bgColor = weekColors[colorIndex];
                
                for (let col = 0; col <= 8; col++) {
                    const cellAddress = XLSX.utils.encode_cell({ r: excelRow, c: col });
                    if (!ws[cellAddress]) ws[cellAddress] = { v: '' };
                    
                    ws[cellAddress].s = {
                        fill: { fgColor: { rgb: bgColor } },
                        alignment: { 
                            horizontal: col <= 4 ? 'center' : 'left',
                            vertical: 'center',
                            wrapText: true
                        },
                        border: {
                            top: { style: 'thin', color: { rgb: 'CCCCCC' } },
                            bottom: { style: 'thin', color: { rgb: 'CCCCCC' } },
                            left: { style: 'thin', color: { rgb: 'CCCCCC' } },
                            right: { style: 'thin', color: { rgb: 'CCCCCC' } }
                        }
                    };
                }
            }
            
            XLSX.utils.book_append_sheet(wb, ws, 'Cronograma');
            
            const fileName = `Cronograma_${studentName.replace(/\s+/g, '_')}_USMLE_Step1.xlsx`;
            XLSX.writeFile(wb, fileName);
        }
        
        // Definir data padrÃ£o e inicializar
        window.onload = function() {
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            const endDate = new Date(tomorrow);
            endDate.setMonth(endDate.getMonth() + 6);
           
            document.getElementById('startDate').valueAsDate = tomorrow;
            document.getElementById('endDate').valueAsDate = endDate;
            
            // Inicializar lista de organizaÃ§Ã£o
            initializeOrganizationList();
            
            // Listener para mudanÃ§a de organizaÃ§Ã£o
            document.querySelectorAll('input[name="organization"]').forEach(radio => {
                radio.addEventListener('change', initializeOrganizationList);
            });
        };
    </script>
</body>
</html>
